var powers = [[0, 0, 0], [1, 0, 0], [0, 1, 0], [0, 0, 1], [2, 0, 0], [1, 1, 0], [1, 0, 1], [0, 2, 0], [0, 1, 1], [0, 0, 2], [3, 0, 0], [2, 1, 0], [2, 0, 1], [1, 2, 0], [1, 1, 1], [1, 0, 2], [0, 3, 0], [0, 2, 1], [0, 1, 2], [0, 0, 3], [4, 0, 0], [3, 1, 0], [3, 0, 1], [2, 2, 0], [2, 1, 1], [2, 0, 2], [1, 3, 0], [1, 2, 1], [1, 1, 2], [1, 0, 3], [0, 4, 0], [0, 3, 1], [0, 2, 2], [0, 1, 3], [0, 0, 4], [5, 0, 0], [4, 1, 0], [4, 0, 1], [3, 2, 0], [3, 1, 1], [3, 0, 2], [2, 3, 0], [2, 2, 1], [2, 1, 2], [2, 0, 3], [1, 4, 0], [1, 3, 1], [1, 2, 2], [1, 1, 3], [1, 0, 4], [0, 5, 0], [0, 4, 1], [0, 3, 2], [0, 2, 3], [0, 1, 4], [0, 0, 5], [6, 0, 0], [5, 1, 0], [5, 0, 1], [4, 2, 0], [4, 1, 1], [4, 0, 2], [3, 3, 0], [3, 2, 1], [3, 1, 2], [3, 0, 3], [2, 4, 0], [2, 3, 1], [2, 2, 2], [2, 1, 3], [2, 0, 4], [1, 5, 0], [1, 4, 1], [1, 3, 2], [1, 2, 3], [1, 1, 4], [1, 0, 5], [0, 6, 0], [0, 5, 1], [0, 4, 2], [0, 3, 3], [0, 2, 4], [0, 1, 5], [0, 0, 6], [7, 0, 0], [6, 1, 0], [6, 0, 1], [5, 2, 0], [5, 1, 1], [5, 0, 2], [4, 3, 0], [4, 2, 1], [4, 1, 2], [4, 0, 3], [3, 4, 0], [3, 3, 1], [3, 2, 2], [3, 1, 3], [3, 0, 4], [2, 5, 0], [2, 4, 1], [2, 3, 2], [2, 2, 3], [2, 1, 4], [2, 0, 5], [1, 6, 0], [1, 5, 1], [1, 4, 2], [1, 3, 3], [1, 2, 4], [1, 1, 5], [1, 0, 6], [0, 7, 0], [0, 6, 1], [0, 5, 2], [0, 4, 3], [0, 3, 4], [0, 2, 5], [0, 1, 6], [0, 0, 7], [8, 0, 0], [7, 1, 0], [7, 0, 1], [6, 2, 0], [6, 1, 1], [6, 0, 2], [5, 3, 0], [5, 2, 1], [5, 1, 2], [5, 0, 3], [4, 4, 0], [4, 3, 1], [4, 2, 2], [4, 1, 3], [4, 0, 4], [3, 5, 0], [3, 4, 1], [3, 3, 2], [3, 2, 3], [3, 1, 4], [3, 0, 5], [2, 6, 0], [2, 5, 1], [2, 4, 2], [2, 3, 3], [2, 2, 4], [2, 1, 5], [2, 0, 6], [1, 7, 0], [1, 6, 1], [1, 5, 2], [1, 4, 3], [1, 3, 4], [1, 2, 5], [1, 1, 6], [1, 0, 7], [0, 8, 0], [0, 7, 1], [0, 6, 2], [0, 5, 3], [0, 4, 4], [0, 3, 5], [0, 2, 6], [0, 1, 7], [0, 0, 8]];

var coefs = [0.0, 2.08603548279, -13.7406581295, 0.0131867425633, 20.5783368326, 25.4951268391, 1.47103125261, -5.09723250862, -0.438853363222, 1.44601527248, 13.6108038411, 53.2439453425, 5.44580423389, -47.5198817855, 0.868155482532, -1.75708873482, -6.40105932661, -5.69016423942, -1.07422225075, -0.0811119901299, -50.3305084481, -70.73783953, 1.83729696442, 39.4382060053, 2.1414679865, -6.76620306913, 6.60007603157, -1.14660289385, 1.51489944337, -0.940594249232, -20.7344125269, 2.9882357176, 3.09952441569, 0.276073980142, -0.554285760115, -16.9729103667, -23.0569739749, -8.84773278541, 30.8544048994, 4.7949119401, 2.23826200549, -38.5126469404, 10.2061462106, 0.200702663721, -0.821342189796, 67.860158366, -4.8489714919, 1.90550193063, -0.57528191495, -0.198854106866, 12.3918878709, 6.99135960406, 3.17311462601, 0.120439802317, 0.0114735469654, 0.0623930699616, 31.6258168621, 43.2085014016, -4.63606231284, -39.1761794471, 1.09479953855, 6.62387059066, 48.7139127083, 0.460962919953, -3.87702907432, 1.2469028299, -3.19963720622, -8.03863058885, 0.749759156197, -0.102981308339, -0.210362335877, -42.1247114472, 1.300735327, -0.0106269667287, 0.857510770004, -0.322790106972, 0.0064007583709, 16.4591992688, -3.58490841228, -4.38820573949, 0.00867683746516, 0.445657580257, -0.198154223001, 0.171005269548, 4.70459093753, 0.777786822927, 4.77759507447, 3.06663366802, -9.82917675784, -0.668890878279, -6.59661667197, -0.983840231746, 0.0887620742927, 0.400919189142, -34.6509287837, 11.8303048315, -0.520597265649, 0.00743254163534, 0.0607768280608, 24.5325478719, -10.4073701285, -1.10112017717, 0.238213569793, -0.00532068027565, -0.0318108921467, -18.2592873276, 0.922179645165, -0.095567630176, 0.284591199273, -0.0999600737164, 0.0149851464698, 0.0261430570126, -3.10349852336, -1.79170977057, -1.19663084091, -0.0564897597956, 0.0155063051552, -0.0174124678467, -0.00734357158089, 0.00181297886493, -5.81880323311, -1.44769209535, 2.86604594406, -12.8027186254, -6.03304561502, -1.73507295004, -26.0086879639, 2.40144591738, 1.60921431314, -0.396794718068, 55.2896788501, 8.15234543218, -1.30136842968, 0.159873075025, 0.134809038478, 6.56589246723, -7.16566997364, 0.535172025281, -0.42703300959, 0.0432197145816, 0.0411311862098, -25.2092258378, 4.44988610615, 1.21515533808, 0.110738104394, -0.0602425242999, -0.0664069519832, -0.00618482376352, 12.1411516568, -0.132051692916, -0.300917488501, -0.290049268984, 0.140492450971, 0.0398420352539, 0.00843028085591, -0.0193100214221, -2.36464834706, 1.02699601735, 1.20310366988, -0.0436559161231, -0.104136592545, 0.0337412694306, -0.0455360851673, 0.0367908464096, -0.0191082636105];

var std = [0.00762781727797, 0.00560671026656, 5.02322978506, 4538.68315781];
var mean = [-33.4489314832, -70.6533702559, 13.6031195841, 1717.95493934];

//receives raw tuple (lat,lng,time)
function obtain_demand(lat,lng,time) {
  //normalization
  lat = (lat - mean[0])/std[0];
  lng = (lng - mean[1])/std[1];
  time = (time - mean[2])/std[2];

  var f = 0;
  var X = [lat,lng,time];
  for (i = 0; i < powers.length; i++){
    f += coefs[i]*(X[0]**powers[i][0])*(X[1]**powers[i][1])*(X[2]**powers[i][2]);
  }
  return f*std[3]+mean[3]; //returns prediction
}
